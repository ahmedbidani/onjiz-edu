!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).exportFromJSON=n()}(this,function(){"use strict";function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function w(t,n){if(!s(t))throw new Error(n)}function g(n){return Object.keys(n).map(function(t){return n[t]})}function O(t){return Object.keys(t)}function p(n){return Object.keys(n).map(function(t){return[t,n[t]]})}function S(t,n){var e="."+n,r=new RegExp("(\\"+n+")?$");return t.replace(/\s+/,"_").replace(r,e)}function C(t,n,e){void 0===e&&(e="download");var r=function(t,n){switch(n){case"txt":return"data:text/plain;charset=utf-8,"+encodeURIComponent(t);case"json":return"data:application/json;charset=utf-8,"+encodeURIComponent(t);case"csv":return"data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(t);case"xls":return"data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(t);case"xml":return"data:application/xml;charset=utf-8,"+encodeURIComponent(t);default:return""}}(t,n),o=document.createElement("a");o.href=r,o.download=e,o.setAttribute("style","visibility:hidden"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function v(t,n){var e="function"==typeof Symbol&&t[Symbol.iterator];if(!e)return t;var r,o,a=e.call(t),c=[];try{for(;(void 0===n||0<n--)&&!(r=a.next()).done;)c.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(e=a.return)&&e.call(a)}finally{if(o)throw o.error}}return c}function I(c){return c.map(p).reduce(function(t,n,a){return n.reduce(function(t,n){var e=n[0],r=n[1],o=t[e]||Array.from({length:c.length}).map(function(t){return""});return o[a]=("string"!=typeof r?JSON.stringify(r):r)||"",t[e]=o,t},t)},Object.create(null))}function E(t){var n,e,r;return'<html>\n  <head>\n    <meta charset="UTF-8">\n  </head >\n  <body>\n    '+(n=I(t),e=O(n),r=g(n).map(function(t){return t.map(function(t){return"<td>"+t+"</td>"})}).reduce(function(t,e){return t.map(function(t,n){return""+t+e[n]})}),"\n    <table>\n      <thead>\n        <tr><th><b>"+e.join("</b></th><th><b>")+"</b></th></tr>\n      </thead>\n      <tbody>\n        <tr>"+r.join("</tr>\n        <tr>")+"</tr>\n      </tbody>\n    </table>\n  ")+"\n  </body>\n</html >\n"}function N(t){return'<?xml version="1.0" encoding="utf-8"?><!DOCTYPE base>\n'+function o(t,n,a,c){void 0===a&&(a="element");void 0===c&&(c=0);var e=(r=n,"555xmlHello .  world!".trim().replace(/^([0-9,;]|(xml))+/,""),r.replace(/[^_a-zA-Z 0-9:\-\.]/g,"").replace(/^([ 0-9-:\-\.]|(xml))+/i,"").replace(/ +/g,"-"));var r;var i=(u=c,Array(u+1).join(" "));var u;if(null==t)return i+"<"+e+" />";var l=s(t)?t.map(function(t){return o(t,a,a,c+2)}).join("\n"):"object"==typeof t?p(t).map(function(t){var n=v(t,2),e=n[0],r=n[1];return o(r,e,a,c+2)}).join("\n"):i+"  "+(d=t.toString(),d.replace(/([<>&])/g,function(t,n){switch(n){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";default:return""}}));var d;var f=i+"<"+e+">\n"+l+"\n"+i+"</"+e+">";return f}(t,"base")+"\n"}function t(t){var n=t.data,e=t.fileName,r=void 0===e?"download":e,o=t.exportType,a=void 0===o?"txt":o,c=t.replacer,i=void 0===c?null:c,u=t.space,l=void 0===u?4:u,d=t.processor,f=void 0===d?C:d,s=t.withBOM,p=void 0!==s&&s,v=t.delimiter,m=void 0===v?",":v,h="Invalid export data. Please provide an array of object",y="Can't export unknown data type "+a+".",x=function(t){try{return"string"==typeof t?JSON.parse(t):t}catch(t){throw new Error("Invalid export data. Please provide a valid JSON")}}(n),b=function(t,n,e){void 0===n&&(n=null);try{return JSON.stringify(t,n,e)}catch(t){throw new Error("Invalid export data. Please provide valid JSON object")}}(x,i,l);switch(a){case"txt":return f(b,a,S(r,"txt"));case"json":return f(b,a,S(r,"json"));case"csv":w(x,h);var j=function(t,r){void 0===r&&(r=",");var n=I(t);return O(n).join(r)+"\r\n"+g(n).map(function(t){return t.map(function(t){return'"'+t.replace(/\"/g,'""')+'"'})}).reduce(function(t,e){return t.map(function(t,n){return""+t+r+e[n]})},[]).join("\r\n")}(x,m);return f(p?"\ufeff"+j:j,a,S(r,"csv"));case"xls":return w(x,h),f(E(x),a,S(r,"xls"));case"xml":return f(N(x),a,S(r,"xml"));default:throw new Error(y)}}var n;return(n=t=t||{}).types={txt:"txt",json:"json",csv:"csv",xls:"xls",xml:"xml"},n.processors={downloadFile:C},t});
